import matplotlib.pyplot as plt

# int 12 - 12 - 12
y0 = [26.28, 40.53, 45.99, 54.18, 58.73, 66.77, 71.48]
x0 = range(len(y0))

# multiple GPUs origin torch
y1 = [19.09, 22.8, 26.19, 32.52, 36.47, 40.93, 43.94, 46.34, 46.27, 49.2, 49.1, 53.21, 56.06, 60.3, 61.11, 58.99, 64.93, 66.74, 67.05, 70.29, 71.43, 71.06, 72.71, 70.47, 75.05, 76.96, 78.14, 79.22, 80.32, 78.41, 83.38, 83.92, 84.26, 83.86, 84.24, 85.07, 85.19, 85.27, 85.4, 84.84, 85.42, 85.63, 85.94, 85.45, 85.63, 86.21, 86.05, 86.15, 85.91, 86.34]
x1 = range(len(y1))

# single GPU apex O1
y2 = [20.950, 38.340, 46.28, 50.58, 59.33, 64.16, 60.66, 70.04, 66.32, 70.94, 77.33, 79.01, 77.98, 80.76, 81.38, 81.11, 82.72, 79.45, 81.45, 84.37, 85.68, 84.61, 84.53, 87.44, 87.91, 86.64, 85.78, 86.97, 88.32, 88.04, 91.64, 92.14, 92, 92.23, 92.26, 92.14, 92.3, 92.39, 92.42, 92.47, 92.2, 92.53, 92.6, 92.52, 92.69, 92.79, 92.68, 92.6, 92.8, 92.48]
x2 = range(len(y2))

# single GPU apex O2
y3 = [20.92, 37.41, 50.42, 53.82, 60.12, 61, 68.86, 69.39, 73.27, 77.2, 75.3, 79.14, 81.17, 79.2, 82.3, 80.72, 81.19, 84.99, 85.18, 83.42, 84.2, 85.8, 80.1, 83.29, 85.54, 87.19, 87.05, 86.93, 86.41, 88.61, 91.44, 91.69, 91.92, 92.05, 92.22, 92.16, 92.24, 92.26, 92.25, 92.24, 92.34, 92.48, 92.45, 92.63, 92.64, 92.62, 92.6, 92.35, 92.47, 92.67]
x3 = range(len(y3))

# single GPU apex O3
y4 = [29.68, 38.01, 44.24, 48.63, 47.72, 64.84, 67.26, 68.91, 73.48, 75.62, 76.4, 79.05, 80.47, 81.85, 82.26, 83.07, 81.97, 81.45, 84.79, 83.87, 85.13, 84.5, 85.13, 81.64, 87.02, 85.93, 86.81, 85.07, 86.86, 88.12, 91.45, 91.65, 91.69, 92.0, 91.73, 92.18, 91.95, 92.28, 92.11, 92.14, 92.34, 92.28, 92.17, 92.24, 92.41, 92.46, 92.61, 92.36, 92.35, 92.66]
x4 = range(len(y4))

# multiple GPUs apex O1
y5 = [10.12, 22.68, 23.34, 30.59, 37.6, 43.04, 50.16, 49.98, 56.34, 62.76, 63.64, 67.8, 69.39, 72.03, 70.56, 75.97, 76.32, 77.11, 78.3, 79.67, 75.68, 79.45, 77.44, 82.79, 82.88, 82.21, 81.66, 81.93, 83.43, 83.73, 89.07, 89.55, 89.87, 89.68, 90.18, 90.22, 90.06, 90.09, 90.31, 90.39, 90.75, 90.54, 90.61, 90.43, 90.68, 90.6, 90.75, 90.68, 90.82, 90.76]
x5 = range(len(y5))

# multiple GPUs apex O2
y6 = [10.63, 18.6, 25.62, 28.78, 39.66, 37.41, 44.55, 45.04, 53.97, 57, 62.75, 62.31, 67.03, 65.7, 69.3, 73.44, 71.43, 73.09, 76.43, 75.66, 77.05, 77.45, 77.87, 77.89, 80.43, 81.59, 81.86, 77.74, 81.89, 82.15, 87.41, 87.27, 87.4, 87.62, 87.87, 87.71, 88.04, 88.12, 88.16, 88.4, 88.06, 88.33, 88.88, 88.91, 88.82, 88.74, 89, 88.61, 88.72, 88.96]
x6 = range(len(y6))

# multiple GPUs apex O3
y7 = [9.6, 18.17, 28.54, 29.09, 35.74, 46.51, 44.38, 51.03, 55.22, 63.24, 61.89, 64.1, 69.8, 66.57, 66.27, 71.76, 74.54, 74.24, 77.34, 77.49, 78.16, 78.35, 78.41, 81.04, 81.23, 81.3, 81.66, 80.57, 82.81, 80.39, 87.6, 88.26, 88.25, 88.44, 88.82, 88.56, 88.52, 88.76, 89.09, 88.88, 88.91, 89.23, 89.52, 89.39, 89.21, 89.19, 89.16, 89.39, 89.5, 89.22]
x7 = range(len(y7))

# multiple GPUs torch model O1
y8 = [10.79, 26.57, 33.85, 39.17, 44.16, 44.57, 52.7, 53.23, 59.39, 62.67, 68.82, 69.6, 69.52, 73.57, 74.59, 76.46, 78.55, 78.11, 76.84, 80.38, 79.02, 82.29, 81.28, 83.72, 82.36, 78.77, 84.9, 84.51, 79.49, 82.98, 89.89, 90.16, 90.46, 90.26, 90.5, 90.61, 90.59, 90.81, 91.02, 91.02, 90.97, 91.27, 91.14, 90.97, 91.23, 91.24, 91.54, 91.58, 91.48, 91.51]
x8 = range(len(y8))

ticks = [(i + 1) * 10 for i in range(10)]

plt.figure(1)
plt.plot(x0, y0, label='single origin torch', color='c')
plt.plot(x1, y1, label='distributed origin torch', color='r')

plt.plot(x2, y2, label='single apex O1', color='y')
plt.plot(x3, y3, label='single apex O2', color='g')
plt.plot(x4, y4, label='single apex O3', color='b')

plt.xlabel('Epoch')
plt.ylabel('Accuracy')

plt.title('Single GPU performance')
plt.legend()
plt.grid(True)
plt.axis([-2, 50, 10, 100])
plt.yticks(ticks)

plt.figure(2)
plt.plot(x5, y5, label='distributed apex O1', color='m')
plt.plot(x6, y6, label='distributed apex O2', color='pink')
plt.plot(x7, y7, label='distributed apex O3', color='lime')

plt.xlabel('Epoch')
plt.ylabel('Accuracy')

plt.title('Multiple GPUs performance')
plt.legend()
plt.grid(True)
plt.axis([-2, 50, 0, 100])
plt.yticks(ticks)

plt.figure(3)
plt.plot(x0, y0, label='single origin torch', color='c')
plt.plot(x8, y8, label='distributed origin torch', color='r')
plt.plot(x2, y2, label='single apex O1', color='y')
plt.plot(x5, y5, label='distributed apex O1', color='m')

plt.xlabel('Epoch')
plt.ylabel('Accuracy')

plt.title('Performance between single and distributed')
plt.legend()
plt.grid(True)
plt.axis([-2, 50, 0, 100])
plt.yticks(ticks)

plt.show()